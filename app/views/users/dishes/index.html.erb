<% @cook = User.find(params[:user_id])%>
<h1 align="center"><%= @cook.name %>'s dishes</h1>


<% if current_user == @cook %>
  <br />
  <div style="overflow-x:auto;">
    <table class="promotions">
      <tr>
        <th>Picture</th>
        <th>Dish</th>
        <th>Price</th>
        <th>Description</th>
        <th>Times Buyed</th>
        <th>Active</th>
      </tr>
      <% current_user&.dishes.each do |dish| %>
        <% @dish = dish %>
          <tr>
            <% if dish.pictures.first %>
              <td><%= link_to image_tag(dish.pictures.first.image.url, :size => '50x50'), dish_path(dish), :class => "dish-avatar" %></td>
            <% else %>
              <td><%= link_to image_tag("https://www.devinecorp.net/cw2/Assets/product_full/107-new.jpg", :size => '50x50'), dish_path(dish), :class => "dish-avatar", :alt => "Dish picture" %></td>
            <% end %>
            <td><%= dish.name %></td>
            <td>$ <%= dish.price %></td>
            <td><%= dish.description %></td>
            <td><%= dish.times_buyed %></td>
            <td><%= link_to dish.activate_text(dish), toggle_activate_dish_path(dish), class: 'activate_dish' %> </td>
            <td><%= link_to 'Preview', dish %></td>
            <td><%= link_to 'Edit', edit_dish_path(dish) %></td>
            <td><%= link_to 'Create Discount', new_dish_discount_path(@dish, :dish_id => @dish.id) %></td>
            <td><%= link_to 'Delete', dish, method: :delete, data: { confirm: 'Are you sure?' } %></td>
          </tr>
      <%end%>
    </table>
  </div>
  <br>
  <%= link_to 'New Dish', new_dish_path %>
<% else %>
    <% @cook.dishes.all_actives.each do |dish| %>
      <%= render 'layouts/dish_item.html', dish: dish%>
    <% end %>
<% end %>
